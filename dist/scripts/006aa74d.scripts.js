"use strict";angular.module("ehrApp",["ui.router"]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/ehr"),b.when("/ehr/charts","/ehr/charts/scheduled"),a.state("ehr",{url:"/ehr",templateUrl:"views/ehr.html",controller:"EhrCtrl"}).state("ehr.home",{url:"/home",templateUrl:"views/home.html"}).state("ehr.schedule",{url:"/schedule",templateUrl:"views/schedule.html"}).state("ehr.tasks",{url:"/tasks",templateUrl:"views/tasks.html"}).state("ehr.charts",{url:"/charts",templateUrl:"views/charts.html",controller:"ChartsCtrl"}).state("ehr.charts.scheduled",{url:"/scheduled",templateUrl:"views/charts.scheduled.html",controller:"ChartsScheduledCtrl"}).state("ehr.charts.recent",{url:"/recent",templateUrl:"views/charts.recent.html"}).state("ehr.charts.search",{url:"/search",templateUrl:"views/charts.search.html"}).state("ehr.messages",{url:"/messages",templateUrl:"views/messages.html"}).state("ehr.reports",{url:"/reports",templateUrl:"views/reports.html"}).state("ehr.lock",{url:"/lock",templateUrl:"views/lock.html"}).state("ehr.settings",{url:"/settings",templateUrl:"views/settings.html"}).state("ehr.help",{url:"/help",templateUrl:"views/help.html"}).state("ehr.feedback",{url:"/feedback",templateUrl:"views/feedback.html"})}]),angular.module("ehrApp").controller("MainCtrl",["$scope","model",function(a,b){a.model=b}]),angular.module("ehrApp").controller("EhrCtrl",["$scope","$state",function(a,b){a.$on("$stateChangeSuccess",function(){a.stateName=b.current.name.split(".")[1]})}]),angular.module("ehrApp").factory("model",function(){return{ccs:["Influenza","Panic Attack","Hypertension","Diabetes","Anemia"],patients:[{id:"p1",image:"images/patient_sarah.png",firstName:"Sarah",lastName:"Williams",sex:"Female",dob:"1984-02-05T00:00:00.00"},{id:"p2",image:"images/patient_alfred.png",firstName:"Alfred",lastName:"Zhang",sex:"Male",dob:"1950-04-12T00:00:00.00"},{id:"p3",image:"images/patient_elsa.png",firstName:"Elsa",lastName:"Freude",sex:"Female",dob:"1930-10-25T00:00:00.00"},{id:"p1",image:"images/patient_sarah.png",firstName:"Sarah",lastName:"Williams",sex:"Female",dob:"1984-02-05T00:00:00.00"},{id:"p2",image:"images/patient_alfred.png",firstName:"Alfred",lastName:"Zhang",sex:"Male",dob:"1950-04-12T00:00:00.00"},{id:"p3",image:"images/patient_elsa.png",firstName:"Elsa",lastName:"Freude",sex:"Female",dob:"1930-10-25T00:00:00.00"},{id:"p1",image:"images/patient_sarah.png",firstName:"Sarah",lastName:"Williams",sex:"Female",dob:"1984-02-05T00:00:00.00"},{id:"p2",image:"images/patient_alfred.png",firstName:"Alfred",lastName:"Zhang",sex:"Male",dob:"1950-04-12T00:00:00.00"},{id:"p3",image:"images/patient_elsa.png",firstName:"Elsa",lastName:"Freude",sex:"Female",dob:"1930-10-25T00:00:00.00"},{id:"p1",image:"images/patient_sarah.png",firstName:"Sarah",lastName:"Williams",sex:"Female",dob:"1984-02-05T00:00:00.00"},{id:"p2",image:"images/patient_alfred.png",firstName:"Alfred",lastName:"Zhang",sex:"Male",dob:"1950-04-12T00:00:00.00"},{id:"p3",image:"images/patient_elsa.png",firstName:"Elsa",lastName:"Freude",sex:"Female",dob:"1930-10-25T00:00:00.00"},{id:"p1",image:"images/patient_sarah.png",firstName:"Sarah",lastName:"Williams",sex:"Female",dob:"1984-02-05T00:00:00.00"},{id:"p2",image:"images/patient_alfred.png",firstName:"Alfred",lastName:"Zhang",sex:"Male",dob:"1950-04-12T00:00:00.00"},{id:"p3",image:"images/patient_elsa.png",firstName:"Elsa",lastName:"Freude",sex:"Female",dob:"1930-10-25T00:00:00.00"}]}}),angular.module("ehrApp").directive("viewCharts",function(){return{templateUrl:"views/view_charts.html",restrict:"E",link:function(a){a.tabs=[{label:"Facesheet",value:"facesheet"},{label:"Timeline",value:"timeline"},{label:"Office Visit",value:"visit"}],a.selectedTab="visit",a.showingInfo=!1,a.charts=[{id:"p1",firstName:"Sarah",lastName:"Williams",image:"images/patient_sarah.png",dob:"1984-02-06T00:00:00+00:00",age:"29",sex:"Female",phone:"4159251230",insurance:"Blueshield",facesheet:{},timeline:{},visit:{cc:"Panic Attack",vitals:{temp:"98.8 rectal",bp:"169/77",pulse:"71",resp:"61",sat:"99%",height:"69 inches",weight:"142 lbs",bmi:"29.2"},medications:[{name:"Naproxen",method:"oral table",dosage:"500 mg",doctor:"Dr. Marie Sheffield",date:"2013-09-13T00:00:00+00:00",refill:"(No refills)"},{name:"Neurontin (gabapentin)",method:"oral table",dosage:"300 mg",doctor:"Dr. Marie Sheffield",date:"2013-09-13T00:00:00+00:00",refill:"(1x refill)"},{name:"Mobic (meloxicam)",method:"oral tablet",dosage:"7.5 mg",doctor:"Dr. Marie Sheffield",date:"2013-09-13T00:00:00+00:00",refill:"(No refills)"},{name:"Flexeril (cyclobeuraprine)",method:"oral tablet",dosage:"300 mg",doctor:"Dr. Marie Sheffield",date:"9/23/2013",refill:"(refill due)"},{name:"Ibuprofen",method:"oral tabelt",dosage:" 200 mg",doctor:"Patient",date:"9/23/2013",refill:"(No refills)"}],problems:[{name:"Sciatica",metric:"724.3",doctor:"Dr. Marie Sheffield",date:"2013-09-13T00:00:00+00:00"},{name:"Obesity, unspecified",metric:"278.00",doctor:"Dr. Marie Sheffield",date:"2013-09-13T00:00:00+00:00"},{name:"Lumbosacral spondylosis without myelopathy",metric:"721.3",doctor:"Dr. Marie Sheffield",date:"2013-09-13T00:00:00+00:00"},{name:"Lumbago",metric:"724.2",doctor:"Dr. Marie Sheffield",date:"2013-09-13T00:00:00+00:00"},{name:"Closed fracture of vault of skull with other and unspecified intracranial hemorrhage with prolonged (more than 24 hours) loss of consciousness and return to pre-existing conscious level",metric:"724.3",doctor:"Dr. Marie Sheffield",date:"2013-09-13T00:00:00+00:00"},{name:"Unspecified essential hypertension",metric:"278.00",doctor:"Patient",date:"2013-09-13T00:00:00+00:00"}],historyMedical:[{name:"Low back pain",doctor:"Patient",date:"2013-09-13T00:00:00+00:00"},{name:"Unspecified essential hypertension",doctor:"Dr. Marie Sheffield",date:"2013-09-13T00:00:00+00:00"}],historySurgical:[{name:"Appendectomy",doctor:"Patient",date:"2013-09-13T00:00:00+00:00"}],historyFamily:[{name:"Heart disease",details:"Father",notes:"Age 56"},{name:"Kidney disease",details:"Mother",notes:"Age 61"}],historySocial:[{name:"Current smoker",details:"22 pack years",notes:""},{name:"Alcohol use",details:"5 drinks a week",notes:""},{name:"Illicit drug use",details:"Occasional marijuana",notes:""},{name:"Sexually active",details:"Male & female partners",notes:"Condom contraception"}],activities:[]}},{id:"p2",firstName:"William",lastName:"Yang",image:"images/patient_silhouette.png",dob:"1980-04-11T00:00:00+00:00",age:"33",sex:"Male",phone:"4151234567",insurance:"Obama Care",facesheet:{},timeline:{},visit:{cc:"Flu",vitals:{temp:"98.8 rectal",bp:"169/77",pulse:"71",resp:"61",sat:"99%",height:"69 inches",weight:"142 lbs",bmi:"29.2"},medications:[{name:"Naproxen",method:"oral table",dosage:"500 mg",doctor:"Dr. Marie Sheffield",date:"2013-09-13T00:00:00+00:00",refill:"(No refills)"},{name:"Neurontin (gabapentin)",method:"oral table",dosage:"300 mg",doctor:"Dr. Marie Sheffield",date:"2013-09-13T00:00:00+00:00",refill:"(1x refill)"},{name:"Mobic (meloxicam)",method:"oral tablet",dosage:"7.5 mg",doctor:"Dr. Marie Sheffield",date:"2013-09-13T00:00:00+00:00",refill:"(No refills)"},{name:"Flexeril (cyclobeuraprine)",method:"oral tablet",dosage:"300 mg",doctor:"Dr. Marie Sheffield",date:"9/23/2013",refill:"(refill due)"},{name:"Ibuprofen",method:"oral tabelt",dosage:" 200 mg",doctor:"Patient",date:"9/23/2013",refill:"(No refills)"}],problems:[{name:"Sciatica",metric:"724.3",doctor:"Dr. Marie Sheffield",date:"2013-09-13T00:00:00+00:00"},{name:"Obesity, unspecified",metric:"278.00",doctor:"Dr. Marie Sheffield",date:"2013-09-13T00:00:00+00:00"},{name:"Lumbosacral spondylosis without myelopathy",metric:"721.3",doctor:"Dr. Marie Sheffield",date:"2013-09-13T00:00:00+00:00"},{name:"Lumbago",metric:"724.2",doctor:"Dr. Marie Sheffield",date:"2013-09-13T00:00:00+00:00"},{name:"Closed fracture of vault of skull with other and unspecified intracranial hemorrhage with prolonged (more than 24 hours) loss of consciousness and return to pre-existing conscious level",metric:"724.3",doctor:"Dr. Marie Sheffield",date:"2013-09-13T00:00:00+00:00"},{name:"Unspecified essential hypertension",metric:"278.00",doctor:"Patient",date:"2013-09-13T00:00:00+00:00"}],historyMedical:[{name:"Low back pain",doctor:"Patient",date:"2013-09-13T00:00:00+00:00"},{name:"Unspecified essential hypertension",doctor:"Dr. Marie Sheffield",date:"2013-09-13T00:00:00+00:00"}],historySurgical:[{name:"Appendectomy",doctor:"Patient",date:"2013-09-13T00:00:00+00:00"}],historyFamily:[{name:"Heart disease",details:"Father",notes:"Age 56"},{name:"Kidney disease",details:"Mother",notes:"Age 61"}],historySocial:[{name:"Current smoker",details:"22 pack years",notes:""},{name:"Alcohol use",details:"5 drinks a week",notes:""},{name:"Illicit drug use",details:"Occasional marijuana",notes:""},{name:"Sexually active",details:"Male & female partners",notes:"Condom contraception"}],activities:[]}}],a.patientLabel=function(a,b){return a+" "+b},a.selectPatient=function(b){a.selectedPatient=b?b:a.charts[0]},a.selectPatient()}}}),angular.module("ehrApp").filter("phone",function(){return function(a){if(!a)return"";var b=a.toString().trim().replace(/^\+/,"");if(b.match(/[^0-9]/))return a;var c,d,e;switch(b.length){case 10:c=1,d=b.slice(0,3),e=b.slice(3);break;case 11:c=b[0],d=b.slice(1,4),e=b.slice(4);break;case 12:c=b.slice(0,3),d=b.slice(3,5),e=b.slice(5);break;default:return a}return 1==c&&(c=""),e=e.slice(0,3)+"-"+e.slice(3),(c+" ("+d+") "+e).trim()}}),angular.module("ehrApp").controller("ChartsCtrl",["$scope","$state",function(a,b){a.$on("$stateChangeSuccess",function(){a.nav2=b.current.name.split(".")[2]}),a.searchUpdate=function(c){a.search=c,c?(a.preSearchState=b.current.name,b.go("ehr.charts.search")):b.go(a.preSearchState)}}]),angular.module("ehrApp").factory("charts",["model",function(a){return{getScheduledPatients:function(){var b=a.patients;return _.each(b,function(b){b.cc=_.sample(a.ccs,1)[0],b.last_visit=moment().subtract("days",_.random(365)).format(),b.last_dx=_.sample(a.ccs,1)[0],b.appt=moment().startOf("day").add("hours",8).add("hours",_.random(8)).format(),b.status="In Room "+_.random(1,10)}),b}}}]),angular.module("ehrApp").controller("ChartsScheduledCtrl",["$scope","charts",function(a,b){a.patients=b.getScheduledPatients(),a.today=moment().format("MMM d, YYYY")}]),angular.module("ehrApp").filter("age",function(){return function(a){return-1*moment.duration(moment(a)-moment()).years()}});